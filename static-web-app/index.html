<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Your $1 Luck Charm</title>
  <!-- Favicon with fallback -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="icon" href="data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2232%22 height=%2232%22 viewBox=%220 0 24 24%22><path fill=%22%239c27b0%22 d=%22M7 3.5c-.8.8-2.2.8-2.8 0c-.6-.7 0-1.7.8-2.1c.8-.4 2-.1 2.4.7c.4.7.1 1-.4 1.4zM9.9 4.4c1.7 1.7 3.6 5 3.2 11.2c2.3-6 1.1-9.7-1-12.1c-2-2.2-5-3-8-2.3l-.2.1c3.2.9 4.7 1.8 6 3.1zm-4.9 8c-.7 1-1 2.2-1 3.5c0 3.2 2.5 5.5 5.8 5.1c2.3-.4 4.2-2.4 4.2-4.7c0-1.3-.5-2.1-1.3-2.7c-.8-.5-1.7-.5-2.5-.3c-1.6.5-2.2 1.5-2.2 2.5c0 .5.2 1 .4 1.5c.4.9-.1 1.7-1 1.7c-1.1 0-2.4-1.2-2.4-3.2c0-1.9 1.1-3.4 3-4.2c.4-.2.8-.2 1.3-.2h3.4c.8 0 1.4-.9.9-1.6c-1.2-1.4-3.5-1.8-5.8-1.1c-1.6.5-2.8 1.4-3.8 2.7z%22/></svg>" />
  <script src="https://js.stripe.com/v3/"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #9c27b0;
      --primary-light: #d05ce3;
      --primary-dark: #6a1b9a;
      --accent: #ffc107;
      --text: #2c2c2c;
      --text-light: #666666;
      --background: #f9f5ff;
      --white: #ffffff;
      --card-bg: rgba(255, 255, 255, 0.8);
      --success: #4CAF50;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Poppins', sans-serif;
      background: var(--background);
      color: var(--text);
      line-height: 1.6;
      background-image: url('https://cdnjs.cloudflare.com/ajax/libs/simple-icons/3.0.1/simpleicons.svg'); /* Placeholder for background pattern */
      background-size: 400px;
      background-position: center;
      background-attachment: fixed;
      background-opacity: 0.1;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding-bottom: 60px;
    }
    
    .page-container {
      display: flex;
      flex-direction: column;
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .logo-header {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 15px 0;
      margin-bottom: 20px;
    }
    
    .logo {
      width: 60px;
      height: 60px;
      margin-right: 15px;
      animation: float 5s infinite ease-in-out;
    }
    
    .logo-text {
      font-family: 'Playfair Display', serif;
      font-size: 1.8rem;
      color: var(--primary-dark);
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    
    .container {
      width: 100%;
      max-width: 480px;
      margin: 10px auto 30px;
      background: var(--card-bg);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 40px 30px;
      box-shadow: 0 15px 35px rgba(156, 39, 176, 0.15), 
                  0 5px 15px rgba(0, 0, 0, 0.07),
                  0 0 0 1px rgba(156, 39, 176, 0.05);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      overflow: hidden;
      position: relative;
    }
    
    .container:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 40px rgba(156, 39, 176, 0.2), 
                  0 10px 20px rgba(0, 0, 0, 0.1),
                  0 0 0 1px rgba(156, 39, 176, 0.08);
    }
    
    /* Magical sparkle effects */
    .container::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.8), transparent 40%);
      opacity: 0;
      z-index: -1;
      transform: scale(0.5);
      transition: transform 1.5s ease, opacity 1.5s ease;
      pointer-events: none;
    }
    
    .container:hover::before {
      opacity: 0.3;
      transform: scale(1);
    }
    
    h1 {
      font-family: 'Playfair Display', serif;
      font-size: 2.2rem;
      margin-bottom: 15px;
      color: var(--primary-dark);
      text-align: center;
      position: relative;
    }
    
    h1::after {
      content: 'âœ¨';
      position: absolute;
      display: inline-block;
      margin-left: 8px;
      font-size: 1.8rem;
      animation: sparkle 2s infinite ease-in-out;
    }
    
    @keyframes sparkle {
      0% { transform: scale(1) rotate(0deg); opacity: 0.7; }
      50% { transform: scale(1.2) rotate(15deg); opacity: 1; }
      100% { transform: scale(1) rotate(0deg); opacity: 0.7; }
    }
    
    .tagline {
      font-size: 1.1rem;
      color: var(--primary);
      text-align: center;
      margin-bottom: 30px;
      font-weight: 600;
    }
    
    .description {
      text-align: center;
      margin-bottom: 35px;
      color: var(--text-light);
      font-size: 0.95rem;
      padding: 0 15px;
      position: relative;
    }
    
    .description::after {
      content: '';
      display: block;
      width: 70px;
      height: 3px;
      background: var(--accent);
      margin: 20px auto 0;
      border-radius: 3px;
    }
    
    .charm-icon {
      font-size: 3rem;
      color: var(--accent);
      margin: 0 auto 20px;
      display: block;
      text-align: center;
      animation: float 5s infinite ease-in-out;
    }
    
    @keyframes float {
      0% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-10px) rotate(5deg); }
      100% { transform: translateY(0) rotate(0deg); }
    }
    
    /* Attention-grabbing elements */
    .limited-offer {
      background: linear-gradient(135deg, #ff9966, #ff5e62);
      color: white;
      padding: 10px 15px;
      border-radius: 50px;
      font-size: 0.85rem;
      font-weight: 600;
      text-align: center;
      margin: 30px auto 10px;
      max-width: 300px;
      box-shadow: 0 5px 15px rgba(255, 94, 98, 0.3);
      position: relative;
      overflow: hidden;
    }
    
    .limited-offer::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      animation: shine 3s infinite;
    }
    
    @keyframes shine {
      0% { transform: rotate(30deg) translate(-100%, -100%); }
      20%, 100% { transform: rotate(30deg) translate(100%, 100%); }
    }
    
    .countdown {
      display: flex;
      justify-content: center;
      margin: 15px 0;
      font-family: 'Poppins', sans-serif;
    }
    
    .countdown-item {
      background: var(--primary-dark);
      color: white;
      width: 40px;
      height: 40px;
      margin: 0 5px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      font-weight: 600;
      box-shadow: 0 4px 10px rgba(156, 39, 176, 0.3);
    }
    
    .countdown-separator {
      display: flex;
      align-items: center;
      color: var(--primary-dark);
      font-weight: 600;
      font-size: 1.2rem;
    }
    
    .form-group {
      margin-bottom: 20px;
      position: relative;
    }
    
    .form-group label {
      display: block;
      font-size: 0.85rem;
      margin-bottom: 5px;
      color: var(--primary);
      font-weight: 500;
      transition: all 0.3s ease;
    }
    
    .form-control {
      width: 100%;
      padding: 15px;
      border: 2px solid rgba(156, 39, 176, 0.2);
      border-radius: 12px;
      font-family: 'Poppins', sans-serif;
      font-size: 1rem;
      color: var(--text);
      background-color: rgba(255, 255, 255, 0.9);
      transition: all 0.3s ease;
      outline: none;
    }
    
    .form-control:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(156, 39, 176, 0.1);
    }
    
    .form-control:hover {
      border-color: var(--primary-light);
    }
    
    .form-icon {
      position: absolute;
      right: 15px;
      top: 43px;
      color: var(--primary-light);
      font-size: 1.2rem;
      pointer-events: none;
    }
    
    .btn {
      width: 100%;
      padding: 16px;
      border: none;
      border-radius: 12px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      font-family: 'Poppins', sans-serif;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 5px 15px rgba(156, 39, 176, 0.3);
      position: relative;
      overflow: hidden;
      margin-top: 15px;
    }
    
    .btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(transparent, rgba(255, 255, 255, 0.2), transparent);
      transform: rotate(30deg);
      transition: transform 0.6s ease;
    }
    
    .btn:hover {
      background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary) 100%);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(156, 39, 176, 0.4);
    }
    
    .btn:hover::after {
      transform: rotate(30deg) translate(100%, 100%);
    }
    
    .btn:active {
      transform: translateY(1px);
      box-shadow: 0 4px 10px rgba(156, 39, 176, 0.3);
    }
    
    .payment-icons {
      margin: 15px 0;
      text-align: center;
      color: var(--text-light);
      font-size: 0.85rem;
    }
    
    .payment-icons i {
      margin: 0 5px;
      font-size: 1.5rem;
      vertical-align: middle;
    }
    
    .guarantee {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 25px;
      padding: 15px;
      background: rgba(76, 175, 80, 0.1);
      border-radius: 12px;
    }
    
    .guarantee i {
      color: var(--success);
      font-size: 1.5rem;
      margin-right: 10px;
    }
    
    .guarantee-text {
      font-size: 0.85rem;
      color: var(--text);
    }
    
    .preview-container {
      margin-top: 40px;
      padding: 25px;
      border-radius: 15px;
      background: rgba(255, 255, 255, 0.7);
      text-align: center;
      display: none;
      animation: fadeIn 0.5s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .preview-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.5rem;
      margin-bottom: 15px;
      color: var(--primary-dark);
    }
    
    .charm-preview {
      margin: 20px auto;
      width: 150px;
      height: 150px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--primary-light), var(--primary-dark));
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 3rem;
      box-shadow: 0 10px 25px rgba(156, 39, 176, 0.3);
      position: relative;
    }
    
    .charm-preview::before {
      content: '';
      position: absolute;
      width: 170px;
      height: 170px;
      border-radius: 50%;
      border: 2px dashed rgba(255, 255, 255, 0.6);
      animation: rotate 20s linear infinite;
    }
    
    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    .benefits {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin: 30px -10px 10px;
    }
    
    .benefit-item {
      flex: 0 0 calc(50% - 20px);
      margin: 0 10px 20px;
      padding: 15px 10px;
      background: rgba(255, 255, 255, 0.7);
      border-radius: 12px;
      text-align: center;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      position: relative;
      overflow: hidden;
      z-index: 1;
    }
    
    .benefit-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    
    .benefit-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle at center, rgba(156, 39, 176, 0.1), transparent);
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: -1;
    }
    
    .benefit-item:hover::before {
      opacity: 1;
    }
    
    .benefit-icon {
      font-size: 2rem;
      color: var(--primary);
      margin-bottom: 10px;
      display: block;
      transition: all 0.3s ease;
    }
    
    .benefit-item:hover .benefit-icon {
      transform: scale(1.2);
      color: var(--primary-dark);
    }
    
    .benefit-text {
      font-size: 0.85rem;
      color: var(--text);
      line-height: 1.3;
      font-weight: 500;
    }
    
    .price-tag {
      position: absolute;
      top: 0;
      right: 0;
      background: var(--accent);
      color: var(--text);
      font-weight: 700;
      padding: 10px 15px;
      font-size: 1.2rem;
      border-radius: 0 20px 0 20px;
      box-shadow: -3px 3px 10px rgba(0, 0, 0, 0.1);
      z-index: 1;
    }
    
    .price-tag small {
      font-size: 0.7rem;
      vertical-align: top;
      margin-right: 3px;
    }
    
    .apple-pay-container {
      margin: 20px 0;
      min-height: 40px;
    }
    
    /* Icon animations */
    .pulse {
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.1); opacity: 0.9; }
      100% { transform: scale(1); opacity: 1; }
    }
    
    .spin-slow {
      animation: spin 10s linear infinite;
    }
    
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    .twinkle {
      animation: twinkle 3s infinite ease-in-out;
    }
    
    @keyframes twinkle {
      0% { opacity: 1; text-shadow: 0 0 0 rgba(156, 39, 176, 0); }
      50% { opacity: 1; text-shadow: 0 0 10px rgba(156, 39, 176, 0.7); }
      100% { opacity: 1; text-shadow: 0 0 0 rgba(156, 39, 176, 0); }
    }
    
    .float-icon {
      animation: float-icon 3s infinite ease-in-out;
    }
    
    @keyframes float-icon {
      0% { transform: translateY(0); }
      50% { transform: translateY(-8px); }
      100% { transform: translateY(0); }
    }
    
    .testimonials {
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid rgba(156, 39, 176, 0.1);
    }
    
    .testimonials-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.3rem;
      color: var(--primary-dark);
      text-align: center;
      margin-bottom: 15px;
    }
    
    .testimonials-slider {
      position: relative;
      overflow: hidden;
      height: 120px;
    }
    
    .testimonial-item {
      position: absolute;
      width: 100%;
      padding: 15px;
      background: rgba(255, 255, 255, 0.6);
      border-radius: 12px;
      text-align: center;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.5s ease, transform 0.5s ease;
    }
    
    .testimonial-item.active {
      opacity: 1;
      transform: translateY(0);
    }
    
    .testimonial-quote {
      font-style: italic;
      font-size: 0.9rem;
      color: var(--text);
      margin-bottom: 10px;
    }
    
    .testimonial-author {
      font-size: 0.8rem;
      color: var(--primary);
      font-weight: 600;
    }
    
    .success-indicators {
      display: flex;
      justify-content: space-between;
      margin: 25px 0 15px;
      text-align: center;
    }
    
    .success-item {
      flex: 1;
    }
    
    .success-number {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--primary-dark);
      margin-bottom: 5px;
      font-family: 'Playfair Display', serif;
    }
    
    .success-label {
      font-size: 0.75rem;
      color: var(--text-light);
    }
    
    .aura-bg {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at 50% 30%, rgba(156, 39, 176, 0.1), transparent 70%);
      z-index: -1;
      opacity: 0.6;
      animation: pulse-bg 10s infinite alternate;
    }
    
    @keyframes pulse-bg {
      0% { opacity: 0.4; transform: scale(1); }
      100% { opacity: 0.8; transform: scale(1.2); }
    }
    
    /* Mystical symbols */
    .mystical-symbols {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      z-index: -1;
      opacity: 0.07;
      pointer-events: none;
    }
    
    .symbol {
      position: absolute;
      font-size: 1.5rem;
      color: var(--primary);
    }
    
    .symbol-1 { top: 10%; left: 10%; animation: float-delay 10s infinite alternate ease-in-out; }
    .symbol-2 { top: 20%; right: 15%; animation: float-delay 12s infinite alternate-reverse ease-in-out; }
    .symbol-3 { bottom: 15%; left: 20%; animation: float-delay 9s infinite alternate ease-in-out; }
    .symbol-4 { bottom: 25%; right: 10%; animation: float-delay 11s infinite alternate-reverse ease-in-out; }
    
    @keyframes float-delay {
      0% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-15px) rotate(5deg); }
      100% { transform: translateY(0) rotate(0deg); }
    }
    
    .footer {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: linear-gradient(90deg, var(--primary-dark), var(--primary));
      color: white;
      text-align: center;
      padding: 10px 0;
      font-size: 0.8rem;
      z-index: 100;
      box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
    }
    
    .footer a {
      color: var(--accent);
      text-decoration: none;
      margin: 0 8px;
      transition: color 0.3s ease;
    }
    
    .footer a:hover {
      color: white;
      text-decoration: underline;
    }
    
    @media (max-width: 480px) {
      .container {
        padding: 30px 20px;
        margin: 0 10px;
      }
      
      h1 {
        font-size: 1.8rem;
      }
      
      .logo-text {
        font-size: 1.5rem;
      }
      
      .benefit-item {
        flex: 0 0 100%;
      }
      
      .form-control {
        padding: 12px;
      }
      
      .logo {
        width: 50px;
        height: 50px;
      }
    }
  </style>
</head>
<body>
  <div class="page-container">
    <div class="logo-header">
      <img src="/images/logo.png" alt="Luck Charm Logo" class="logo" onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2260%22 height=%2260%22 viewBox=%220 0 24 24%22><path fill=%22%239c27b0%22 d=%22M7 3.5c-.8.8-2.2.8-2.8 0c-.6-.7 0-1.7.8-2.1c.8-.4 2-.1 2.4.7c.4.7.1 1-.4 1.4zM9.9 4.4c1.7 1.7 3.6 5 3.2 11.2c2.3-6 1.1-9.7-1-12.1c-2-2.2-5-3-8-2.3l-.2.1c3.2.9 4.7 1.8 6 3.1zm-4.9 8c-.7 1-1 2.2-1 3.5c0 3.2 2.5 5.5 5.8 5.1c2.3-.4 4.2-2.4 4.2-4.7c0-1.3-.5-2.1-1.3-2.7c-.8-.5-1.7-.5-2.5-.3c-1.6.5-2.2 1.5-2.2 2.5c0 .5.2 1 .4 1.5c.4.9-.1 1.7-1 1.7c-1.1 0-2.4-1.2-2.4-3.2c0-1.9 1.1-3.4 3-4.2c.4-.2.8-.2 1.3-.2h3.4c.8 0 1.4-.9.9-1.6c-1.2-1.4-3.5-1.8-5.8-1.1c-1.6.5-2.8 1.4-3.8 2.7z%22/></svg>'">
      <h1 class="logo-text">Your $1 Luck Charm</h1>
    </div>
    
    <div class="container">
      <div class="price-tag"><small>ONLY</small>$1</div>
      <div class="aura-bg"></div>
      <div class="mystical-symbols">
        <i class="fas fa-moon symbol symbol-1"></i>
        <i class="fas fa-star symbol symbol-2"></i>
        <i class="fas fa-infinity symbol symbol-3"></i>
        <i class="fas fa-sun symbol symbol-4"></i>
      </div>
      
      <i class="fas fa-magic charm-icon"></i>
      <h1>Your Luck Charm</h1>
      <p class="tagline">Personalized Good Fortune, Just For You</p>
      
      <p class="description">An AI-generated talisman uniquely crafted to your birth energy and desires. Activate your custom luck charm with just $1.</p>
      
      <div class="limited-offer">
        ðŸ”® Special Launch Offer - Next 100 Charms Only ðŸ”®
      </div>
      
      <div class="countdown">
        <div class="countdown-item">1</div>
        <div class="countdown-item">9</div>
        <div class="countdown-separator">:</div>
        <div class="countdown-item">5</div>
        <div class="countdown-item">2</div>
      </div>
      
      <div class="success-indicators">
        <div class="success-item">
          <div class="success-number">98%</div>
          <div class="success-label">Satisfaction</div>
        </div>
        <div class="success-item">
          <div class="success-number">5,431</div>
          <div class="success-label">Happy Users</div>
        </div>
        <div class="success-item">
          <div class="success-number">24h</div>
          <div class="success-label">Active Time</div>
        </div>
      </div>
      
      <div class="benefits">
        <div class="benefit-item">
          <i class="fas fa-bolt benefit-icon pulse"></i>
          <p class="benefit-text">Instantly Generated</p>
        </div>
        <div class="benefit-item">
          <i class="fas fa-fingerprint benefit-icon spin-slow"></i>
          <p class="benefit-text">Uniquely Yours</p>
        </div>
        <div class="benefit-item">
          <i class="fas fa-sparkles benefit-icon twinkle"></i>
          <p class="benefit-text">Positive Energy</p>
        </div>
        <div class="benefit-item">
          <i class="fas fa-crown benefit-icon float-icon"></i>
          <p class="benefit-text">Amplifies Intentions</p>
        </div>
      </div>
      
      <form id="charmForm">
        <div class="form-group">
          <label for="name">Your Name</label>
          <input type="text" id="name" class="form-control" placeholder="Enter your full name" required>
          <i class="fas fa-user form-icon"></i>
        </div>
        
        <div class="form-group">
          <label for="birthdate">Your Birthdate</label>
          <input type="date" id="birthdate" class="form-control" required>
          <i class="fas fa-calendar-alt form-icon"></i>
        </div>
        
        <div class="form-group">
          <label for="email">Your Email</label>
          <input type="email" id="email" class="form-control" placeholder="Where to send your charm" required>
          <i class="fas fa-envelope form-icon"></i>
        </div>
        
        <div class="form-group">
          <label for="goal">What Do You Need Luck With?</label>
          <select id="goal" class="form-control" required>
            <option value="" disabled selected>Select your desire</option>
            <option value="job">Ace That Job Interview</option>
            <option value="date">Enchanting Date Night</option>
            <option value="exam">Success in Exams</option>
            <option value="money">Financial Prosperity</option>
            <option value="health">Vibrant Wellbeing</option>
            <option value="other">Something Else</option>
          </select>
          <i class="fas fa-star form-icon"></i>
        </div>
        
        <div id="stripe-container" class="apple-pay-container"></div> <!-- Stripe Apple Pay mounts here -->
        
        <button type="submit" class="btn">
          <i class="fab fa-apple-pay"></i> Pay $1 with Apple Pay
        </button>
        
        <div class="payment-icons">
          Quick & Secure Payment with
          <i class="fab fa-apple-pay"></i>
        </div>
        
        <div class="guarantee">
          <i class="fas fa-shield-alt"></i>
          <p class="guarantee-text">Instant digital delivery. Simple Apple Pay checkout.</p>
        </div>
      </form>
      
      <div class="testimonials">
        <h3 class="testimonials-title">What People Are Saying</h3>
        <div class="testimonials-slider" id="testimonials-slider">
          <div class="testimonial-item active">
            <p class="testimonial-quote">"I got my luck charm before a big interview. You won't believe it, but I got the job that same day!"</p>
            <p class="testimonial-author">- Sarah T.</p>
          </div>
          <div class="testimonial-item">
            <p class="testimonial-quote">"I was skeptical, but my exam scores improved right after getting my charm. Coincidence? Maybe, but I'm keeping it!"</p>
            <p class="testimonial-author">- James K.</p>
          </div>
          <div class="testimonial-item">
            <p class="testimonial-quote">"The energy shift was immediate. Within a week, I met someone special on a date that almost got cancelled!"</p>
            <p class="testimonial-author">- Mia L.</p>
          </div>
        </div>
      </div>
      
      <div id="preview" class="preview-container">
        <h2 class="preview-title">Your Personalized Charm</h2>
        <div class="charm-preview">
          <i class="fas fa-sun"></i>
        </div>
        <p>Your custom luck charm has been created! Check your email for the full details.</p>
      </div>
    </div>
  </div>
  
  <div class="footer">
    <p>Powered by Stripe & Azure. &copy; 2025 Luck Charm App. 
    <a href="/privacy">Privacy Policy</a> | <a href="/terms">Terms of Service</a></p>
  </div>
  
  <script>
    // Initialize Stripe
    const stripe = Stripe('pk_live_51SKMcz4WZnjSGoTDWg7zWjDtkbnL9sjTZ9DAvMREoxtEcZx3YA2eLGgQ141OZX36r3svVPGXAPLqTxPV3V6dfrOo00OEXaQe2i'); // Replace with your actual publishable key
    
    // Set up payment request for Apple Pay
    const paymentRequest = stripe.paymentRequest({
      country: 'US',
      currency: 'usd',
      total: {
        label: 'Personalized Luck Charm',
        amount: 100, // $1.00 in cents
      },
      requestPayerName: true,
      requestPayerEmail: true,
    });
    
    // Check if Apple Pay is available
    const elements = stripe.elements();
    const prButton = elements.create('paymentRequestButton', {
      paymentRequest,
      style: {
        paymentRequestButton: {
          theme: 'dark',
          height: '44px',
        },
      }
    });
    
    // Mount Apple Pay button if available
    paymentRequest.canMakePayment().then(function(result) {
      if (result && result.applePay) {
        prButton.mount('#stripe-container');
      } else {
        document.getElementById('stripe-container').innerHTML = 
          '<p style="color: var(--text-light); font-size: 0.8rem; text-align: center; margin: 10px 0;">Apple Pay not available on this device. Please try on a compatible device.</p>';
      }
    });
    // Get the form element
    const form = document.getElementById('charmForm');
    // Stripe checkout success handler
    form.addEventListener('submit', async function(e) {
      e.preventDefault();
      
      // Validate form
      if (!form.checkValidity()) {
        alert('Please fill out all required fields');
        return;
      }
      
      const submitButton = this.querySelector('button[type="submit"]');
      const originalButtonText = submitButton.innerHTML;
      
      try {
        // Disable button and show loading state
        submitButton.disabled = true;
        submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
        
        // Get form data
        const name = document.getElementById('name').value;
        const birthdate = document.getElementById('birthdate').value;
        const email = document.getElementById('email').value;
        const goal = document.getElementById('goal').value;
        
        // Call Azure function to create checkout session
const response = await fetch('https://luck-charm-api-dheaebeueycwhnc9.westeurope-01.azurewebsites.net/api/create-checkout-session', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    name,
    birthdate,
    email,
    goal,
    amount: 100,
    payment_type: 'regular'
  }),
});

if (!response.ok) {
  throw new Error('Error creating checkout session');
}

const data = await response.json();

// Redirect to Stripe Checkout
const result = await stripe.redirectToCheckout({
  sessionId: data.sessionId,
});

if (result.error) {
  throw new Error(result.error.message);
}

} catch (error) {
  console.error('Error:', error);
  alert('There was an error processing your payment: ' + error.message);
  
  // Re-enable button
  submitButton.disabled = false;
  submitButton.innerHTML = originalButtonText;
}
});

// Document ready event - check URL for session_id (from Stripe redirect)
document.addEventListener('DOMContentLoaded', async function() {
  // Check for session_id in URL (Stripe callback)
  const urlParams = new URLSearchParams(window.location.search);
  const sessionId = urlParams.get('session_id');
  const success = urlParams.get('success');
  
  if (sessionId && success === 'true') {
    try {
      // Call Azure function to generate charm after redirect from successful payment
      await generateCharm(sessionId);
    } catch (error) {
      console.error('Error:', error);
      alert('There was an error generating your charm. Please contact support.');
    }
  }
});

// Handle payment request confirmation (Apple Pay)
paymentRequest.on('paymentmethod', async function(ev) {
  const name = document.getElementById('name').value;
  const birthdate = document.getElementById('birthdate').value;
  const email = document.getElementById('email').value;
  const goal = document.getElementById('goal').value;
  
  try {
    // Call Azure function to create checkout session with payment method
    const response = await fetch('https://luck-charm-api-dheaebeueycwhnc9.westeurope-01.azurewebsites.net/api/create-checkout-session', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        name,
        birthdate,
        email,
        goal,
        amount: 100, // $1.00 in cents
        payment_method_id: ev.paymentMethod.id,
        payment_type: 'apple_pay'
      }),
    });
    
    if (!response.ok) {
      throw new Error('Error creating checkout session');
    }
        
        const data = await response.json();
        
        // Complete the Apple Pay payment
        ev.complete('success');
        
        // Generate charm after successful payment
        await generateCharm(data.paymentId || data.sessionId);
        
      } catch (error) {
        console.error('Error:', error);
        ev.complete('fail');
        alert('There was an error processing your payment. Please try again.');
      }
    });
    
// Function to generate charm after successful payment
async function generateCharm(paymentId) {
  try {
    // Call Azure function to generate charm
    const response = await fetch('https://luck-charm-api-dheaebeueycwhnc9.westeurope-01.azurewebsites.net/api/generateCharm', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        paymentId, // Could be sessionId or paymentIntentId depending on payment flow
      }),
    });
    
    if (!response.ok) {
      throw new Error('Error generating charm');
    }
    
    const data = await response.json();
    
    // Update URL without reload to remove query params
    window.history.replaceState({}, document.title, window.location.pathname);
    
    // Show the preview with animation
    preview.style.display = 'block';
    
    // Scroll to preview
    preview.scrollIntoView({ behavior: 'smooth' });
    
    // Clear form inputs for a clean state
    form.reset();
    
    // Update the preview with actual charm data
    if (data.charmSymbol) {
      document.querySelector('.charm-preview i').className = data.charmSymbol;
    }
    
    // If we have a custom message, update the preview text
    if (data.message) {
      const previewText = document.querySelector('#preview p');
      if (previewText) {
        previewText.textContent = data.message;
      }
    }
    
  } catch (error) {
    console.error('Error generating charm:', error);
    alert('Payment successful! However, there was an error generating your charm. Our team has been notified and will email your charm shortly.');
  }
}
    
    // Form field animations
    const formControls = document.querySelectorAll('.form-control');
    
    formControls.forEach(control => {
      control.addEventListener('focus', function() {
        this.parentElement.querySelector('label').style.color = '#9c27b0';
      });
      
      control.addEventListener('blur', function() {
        this.parentElement.querySelector('label').style.color = '';
      });
    });
    
    // Testimonial slider
    let currentTestimonial = 0;
    const testimonials = document.querySelectorAll('.testimonial-item');
    
    function showNextTestimonial() {
      testimonials[currentTestimonial].classList.remove('active');
      currentTestimonial = (currentTestimonial + 1) % testimonials.length;
      testimonials[currentTestimonial].classList.add('active');
    }
    
    // Change testimonial every 5 seconds
    setInterval(showNextTestimonial, 5000);
    
    // Simple countdown timer
    let minutes = 19;
    let seconds = 52;
    const minutesTens = document.querySelector('.countdown-item:nth-child(1)');
    const minutesOnes = document.querySelector('.countdown-item:nth-child(2)');
    const secondsTens = document.querySelector('.countdown-item:nth-child(4)');
    const secondsOnes = document.querySelector('.countdown-item:nth-child(5)');
    
    function updateCountdown() {
      seconds--;
      if (seconds < 0) {
        seconds = 59;
        minutes--;
        if (minutes < 0) {
          minutes = 59;
        }
      }
      
      minutesTens.textContent = Math.floor(minutes / 10);
      minutesOnes.textContent = minutes % 10;
      secondsTens.textContent = Math.floor(seconds / 10);
      secondsOnes.textContent = seconds % 10;
    }
    
    // Update countdown every second
    setInterval(updateCountdown, 1000);
  </script>
</body>
</html>